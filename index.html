<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday Janhavi!</title>
    <style>
        *{ margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: linear-gradient( to right, #f8cdda, #072dc5);
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            font-family: 'Comic Sans MS', cursive;
        }

        .card {
            width: 400px;
            height: 300px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
            transform: rotateY(0deg);
            transform-style: preserve-3d;
            transition: transform 1s;
            cursor: pointer;

        }


        .front, .back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            text-align: center;
            padding: 20px;

        }

        .front {
            background: #ffb6c1;
            color: #fff;
        }

        .back {
            background: #fff;
            transform: rotateY(180deg);
            color: #333;
        }

        .cake {
            margin-top: 10px;
            position: relative;
        }

        .cake .layer {
            width: 150px;
            height: 40px;
            background: rgb(57, 21, 27);
            border: 2px solid #650736;
            margin: 5px auto;
            border-radius: 10px;
        }

        .candles {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: -10px;
        }

        .candle {
            width: 10px;
            height: 30px;
            background: orange;
            position: relative;

        }

        .flame {
            width: 10px;
            height: 20px;
            background: radial-gradient(circle, yellow 30%, orange 70%);
            position: absolute;
            top: -20px;
            left: -1px;
            border-radius: 50%;
            animation: flicker 0.3s infinite;
        }

    
        @keyframes flicker {
            0% {transform: scale(1); opacity: 1;}
            50% {transform: scale(1,2); opacity: 0.8;}
            100% {transform: scale(1); opacity: 1;}
        }

        h1 {
            font-size: 1.2em;
            color: #555;
        }

        p {
            font-size: 1.2em;
            color: #888;
        }

        canvas#confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 999;
        }
        
        
        
    </style>
</head>
<body>
    <canvas id="confetti-canvas"></canvas>
    <div class="card" id="card">
    <div class="front">
        <h1>ðŸŽ‚ Here's your cake!</h1>
        <div class="candles" id="candles">
            <div class="candle"> <div class="flame"></div></div>
            <div class="candle"> <div class="flame"></div></div>
            </div>
            <div class="cake">
                <div class="layer"></div>
                <div class="layer"></div>
                <div class="layer"></div>
            </div>
            <p class="hint"> Blow into your mic to blow out the candles!!ðŸŽ¤</p>
            </div>
            </div>

            <audio id="music" src="https://www.bensound.com/bensound-music/bensound-celebration.mp3" loop></audio>

            <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
            <script>
                const card =
                document.getElementById("card");
                const flames =card
                document.querySelectorAll(".flame");
                const music = 
                document.getElementById("music");

                card.addEventListener("click", () => {
                    if (!card.classList.contains("opened")) {
                        card.classList.add("opened");
                        music.play();
                        launchConfetti();
                        startMic();
                    }
                });

                function extinguishCandles() {
      flames.forEach(flame => flame.style.display = "none");
    }

    async function startMic() {
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      const source = audioCtx.createMediaStreamSource(stream);
      const analyser = audioCtx.createAnalyser();
      source.connect(analyser);

      const data = new Uint8Array(analyser.frequencyBinCount);

      function detectBlow() {
        analyser.getByteFrequencyData(data);
        let volume = data.reduce((a, b) => a + b) / data.length;
        if (volume > 50) {
          extinguishCandles();
          stream.getTracks().forEach(track => track.stop());
        } else {
          requestAnimationFrame(detectBlow);
        }
      }

      detectBlow();
    }

    function launchConfetti() {
      const duration = 3 * 1000;
      const end = Date.now() + duration;

      (function frame() {
        confetti({
          particleCount: 6,
          angle: 60,
          spread: 55,
          origin: { x: 0 },
        });
        confetti({
          particleCount: 6,
          angle: 120,
          spread: 55,
          origin: { x: 1 },
        });
        if (Date.now() < end) {
          requestAnimationFrame(frame);
        }
      })();
    }
  </script>
</body>
</html>

          



